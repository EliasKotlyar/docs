
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>"OK Google, start my car!" Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="../getting-started/atCommands.html" />
    

    </head>
    <body>
        
<header class="main-header">
    <h1 class="main-header__title"><a href="https://macchina.cc" class="main-header__link"><img src="/images/logo.svg" alt="Macchina logo" class="main-header__logo"></a> Docs</h1>
</header>

<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    M2 Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../m2/">
            
                <a href="../../m2/">
            
                    
                    About M2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../m2/versions.html">
            
                <a href="../../m2/versions.html">
            
                    
                    Versions of M2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../m2/disclaimer.html">
            
                <a href="../../m2/disclaimer.html">
            
                    
                    Disclaimer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../../m2/getting-started/">
            
                <a href="../../m2/getting-started/">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../../m2/getting-started/arduino.html">
            
                <a href="../../m2/getting-started/arduino.html">
            
                    
                    Arduino IDE Quick Start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" >
            
                <span>
            
                    
                    Detailed Reference
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../../m2/technical-references/installation.html">
            
                <a href="../../m2/technical-references/installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" data-path="../../m2/technical-references/processor.html">
            
                <a href="../../m2/technical-references/processor.html">
            
                    
                    Processor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.2.1" data-path="../../m2/technical-references/pin-mapping.html">
            
                <a href="../../m2/technical-references/pin-mapping.html">
            
                    
                    Pin Mapping
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6.3" data-path="../../m2/technical-references/interfaces.html">
            
                <a href="../../m2/technical-references/interfaces.html">
            
                    
                    Automotive Interfaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.4" data-path="../../m2/technical-references/communication.html">
            
                <a href="../../m2/technical-references/communication.html">
            
                    
                    Communication
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.4.1" data-path="../../m2/build-something/cellular.html">
            
                <a href="../../m2/build-something/cellular.html">
            
                    
                    Cellular
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6.5" data-path="../../m2/technical-references/power.html">
            
                <a href="../../m2/technical-references/power.html">
            
                    
                    Power
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.6" data-path="../../m2/technical-references/memory.html">
            
                <a href="../../m2/technical-references/memory.html">
            
                    
                    Storage/Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.7" data-path="../../m2/technical-references/12vio.html">
            
                <a href="../../m2/technical-references/12vio.html">
            
                    
                    12V IO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.8" data-path="../../m2/technical-references/leds-buttons.html">
            
                <a href="../../m2/technical-references/leds-buttons.html">
            
                    
                    LEDS/Buttons
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.9" data-path="../../m2/technical-references/enclosures.html">
            
                <a href="../../m2/technical-references/enclosures.html">
            
                    
                    Enclosures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.10" data-path="../../m2/technical-references/byob.html">
            
                <a href="../../m2/technical-references/byob.html">
            
                    
                    Breakout Board
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.11" data-path="../../m2/technical-references/open-source.html">
            
                <a href="../../m2/technical-references/open-source.html">
            
                    
                    Schematics and Source
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Experimental Projects
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../pb_adapter/">
            
                <a href="../../pb_adapter/">
            
                    
                    PocketBeagle Adapter board
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../M2VoltageMonitor/">
            
                <a href="../../M2VoltageMonitor/">
            
                    
                    Help Collect Voltage Data
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    SuperB Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../">
            
                <a href="../">
            
                    
                    About SuperB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../hardware.html">
            
                <a href="../hardware.html">
            
                    
                    Hardware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../getting-started/">
            
                <a href="../getting-started/">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" >
            
                <span>
            
                    
                    Flashing SuperB with USB Adapter Board
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../flashing/esp.html">
            
                <a href="../flashing/esp.html">
            
                    
                    Using ESP Tool
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="../flashing/arduino.html">
            
                <a href="../flashing/arduino.html">
            
                    
                    Using Arduino IDE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.5" >
            
                <span>
            
                    
                    Flashing SuperB with M2
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../flashing/arduinoM2.html">
            
                <a href="../flashing/arduinoM2.html">
            
                    
                    Using Arduino IDE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../getting-started/atCommands.html">
            
                <a href="../getting-started/atCommands.html">
            
                    
                    Sending AT Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.7" data-path="ok_google_start_my_car.html">
            
                <a href="ok_google_start_my_car.html">
            
                    
                    "OK Google, start my car!"
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                

                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >"OK Google, start my car!"</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="ok-google-start-my-car">&quot;OK Google, start my car!&quot;</h1>
<p>Remotely start and stop a car using M2 with SuperB!</p>
<p><strong>Hardware Needed:</strong>  </p>
<ul>
<li><a href="https://www.macchina.cc/catalog/m2-boards/m2-under-dash" target="_blank">M2</a></li>
<li><a href="https://www.macchina.cc/catalog/m2-accessories/superb" target="_blank">SuperB</a></li>
<li>Smartphone with Google Assistant</li>
</ul>
<p><strong>Services Needed:</strong></p>
<ul>
<li>Google Assistant</li>
<li><a href="https://ifttt.com/join" target="_blank">If This then That (IFTTT)</a></li>
<li><a href="https://io.adafruit.com/" target="_blank">Adafruit IO</a></li>
</ul>
<h2 id="theory">Theory</h2>
<p><img src="../../images/Ok_Google_Car/Flowchart.png" alt="Flowchart showing the relationship between hardware and services used"></p>
<ul>
<li>Voice commands will be given to either a smartphone or a Google Home device</li>
<li>Voice data is passed to Google Assistant</li>
<li>Google Assistant then triggers IFTTT with either an ON or OFF command</li>
<li>IFTTT in turn updates Adafruit IO with the ON or OFF command</li>
<li>SuperB receives the ON or OFF command and updates itself to reflect the new state</li>
<li>M2 reads the ON/OFF state of SuperB and then starts or stops the car</li>
</ul>
<h3 id="implications-expansion">Implications, Expansion</h3>
<ul>
<li>Other than Google Assistant, IFTTT supports a huge number of triggers. (e.g. weather, connect/disconnect from Wi-Fi networks, time, etc.) For example, have your car warm up before leaving for work if the temperature is below a certain threshold.</li>
<li>Because the smartphone and SuperB are never directly connected, commands can be sent to the vehicle as long as both devices have an internet connection, regardless of the physical distance between them.</li>
</ul>
<h2 id="google-assistant">Google Assistant</h2>
<p>You&apos;ll need either a smartphone capable of accessing Google Assistant or a Google Home device. In either case, make sure you know the credentials of the Google account associated with the device.</p>
<h2 id="if-this-then-that-ifttt">If This then That (IFTTT)</h2>
<p>If This then That will handle the exchange between Google Assistant and Adafruit IO, and adds the option to use a trigger other than a voice command. Register for an account <a href="https://ifttt.com/join" target="_blank">here.</a> Make sure to link the same Google account used on your smartphone or Google Home.</p>
<h2 id="adafruit-io">Adafruit IO</h2>
<p>Adafruit IO is an easy to use web service that can control internet enabled hardware (like M2 and SuperB). IO provides a virtual dashboard accesible through a web browser onto which all manner of gauges, sliders, buttons, and switches can be placed. For our purposes we&apos;ll have a dashboard with a simple ON/OFF switch, the state of which the SuperB will be able to read. What makes IO extremely useful is that these switches can be controlled by other web services like IFTTT, and not just through the web dashboard. Register for an account <a href="https://io.adafruit.com/" target="_blank">here.</a></p>
<h2 id="step-1-set-up-adafruit-io">Step 1-Set up Adafruit IO</h2>
<ol>
<li>Create a new feed titled &quot;LED_Control&quot;. (case-sensitive!)
 <img src="../../images/Ok_Google_Car/AdafruitIO1.PNG" alt="image showing how to create a feed">
 <img src="../../images/Ok_Google_Car/AdafruitIO2.PNG" alt="image showing how to create a feed"></li>
<li>Create a new dashboard with any title.
 <img src="../../images/Ok_Google_Car/AdafruitIO3.PNG" alt="image showing how to create a dashboard"></li>
<li>Navigate to the new dashboard and place a toggle switch linked to the &quot;LED_Control&quot; feed. Leave the block settings on their default settings.
 <img src="../../images/Ok_Google_Car/AdafruitIO4.PNG" alt="image showing how to create a toggle switch">
 <img src="../../images/Ok_Google_Car/AdafruitIO5.PNG" alt="image showing how to create a toggle switch">
 <img src="../../images/Ok_Google_Car/AdafruitIO6.PNG" alt="image showing the settings for the toggle switch"></li>
<li>There should now be a single toggle switch on the dashboard:
 <img src="../../images/Ok_Google_Car/AdafruitIO7.PNG" alt="image showing the switch on the dashboard"></li>
<li>Find and record your username and key, which will be necessary later.
 <img src="../../images/Ok_Google_Car/AdafruitIO8.PNG" alt="image showing where to find username and key"></li>
</ol>
<h2 id="step-2-set-up-and-test-superb">Step 2-Set up and Test SuperB</h2>
<ol>
<li>Download the SuperB sketch <a href="https://github.com/kenny-macchina/Ok-Google-Start-My-Car/tree/master/SuperB_Sketch" target="_blank">here.</a> (This sketch uses the Adafruit MQTT library which can be installed through the Arduino library manager)</li>
<li>Update the sketch with your Adafruit IO and Wi-Fi credentials.
 <img src="../../images/Ok_Google_Car/SuperB1.PNG" alt="image showing where to update credentials in sketch"></li>
<li>To flash SuperB with M2 follow the instructions <a href="http://docs.macchina.cc/superB/flashing/arduinoM2.html" target="_blank">here.</a> Alternatively, if you have an XBee USB adapter board you can flash SuperB using the instructions found <a href="http://docs.macchina.cc/superB/hardware.html#use-xbee-usb-adapter-to-flash" target="_blank">here.</a></li>
<li>Power on SuperB (either with an M2 or USB adapter board) and use the Adafruit IO dashboard to test the functionality.<br> <img src="../../images/Ok_Google_Car/SuperB2.gif" alt="image showing SuperB responding to Adafruit IO dashboard"></li>
</ol>
<h2 id="step-3-set-up-and-test-ifttt">Step 3-Set up and Test IFTTT</h2>
<ol>
<li>Create a new applet with Google Assistant as the trigger (the &quot;this&quot;).<br> <img src="../../images/Ok_Google_Car/IFTTT1.PNG" alt="image showing Google Assistant in IFTTT"></li>
<li>Select Adafruit IO as the action (the &quot;that&quot;). Connect your Adafruit account to IFTTT if prompted. Select the &quot;LED_Control&quot; feed and enter &quot;ON&quot; (case-sensitive) as the data to save to the feed.<br> <img src="../../images/Ok_Google_Car/IFTTT2.PNG" alt="image showing Adafruit IO in IFTTT"></li>
<li>In the same style create another applet to turn the car off, sending &quot;OFF&quot; instead of &quot;ON&quot;.</li>
<li>With these 2 applets you should now be able to control the toggle switch on your IO dashboard via Google Assistant.
 <img src="../../images/Ok_Google_Car/IFTTT3.PNG" alt="image showing the 2 applets just created">
 <img src="../../images/Ok_Google_Car/IFTTT4.gif" alt="image showing Google Assistant controlling Adafruit IO and SuperB"><br>Great! At this point we can toggle a pin on SuperB using Google Assistant. The final step is to have M2 read the pin state and then perform an action on the car accordingly.<br>If you&apos;re interested in using more than just one pin the SuperB pinout can be found <a href="http://docs.macchina.cc/superB/hardware.html" target="_blank">here,</a> and the pinout for the M2&apos;s XBee socket can be found <a href="http://docs.macchina.cc/m2/technical-references/pin-mapping.html#xbee" target="_blank">here.</a></li>
</ol>
<h2 id="step-4-flash-m2">Step 4-Flash M2</h2>
<ol>
<li>Download the M2 sketch <a href="https://github.com/kenny-macchina/Ok-Google-Start-My-Car/tree/master/M2_Sketch" target="_blank">here.</a></li>
<li>This sketch uses the M2_12VIO library found <a href="https://github.com/TDoust/M2_12VIO" target="_blank">here,</a> the pwm library found <a href="https://github.com/antodom/pwm_lib" target="_blank">here,</a> and the mcp2515 library found <a href="https://github.com/macchina/Single-Wire-CAN-mcp2515" target="_blank">here,</a> make sure you have them installed.</li>
<li>Determine which version of M2 you have <a href="http://docs.macchina.cc/m2/versions.html" target="_blank">here.</a> Comment out the V4 specific line in the readBatteryVoltage() function if you have V3 or earlier, otherwise leave the code as is.
 <img src="../../images/Ok_Google_Car/M21.PNG" alt="image showing code to modify for different versions of M2"></li>
<li>The startCarSpecific() and stopCarSpecific() functions are pre-populated with GM specific CAN messages. You&apos;ll have to determine what CAN messages to send for other cars. (This may take some work to determine!)
 <img src="../../images/Ok_Google_Car/M22.PNG" alt="image showing start and stop functions"></li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
<footer>
    Can't find what your are looking for?  <a href="https://github.com/macchina/docs/issues">Open an Issue on GitHub</a> or <a href="https://forum.macchina.cc/">ask on the Forum</a>.
    <br/><br/>
    This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
    All code samples in this work are released to the public domain using the <a href="http://creativecommons.org/publicdomain/zero/1.0/">Creative Commons CC0 Public Domain Dedication</a>.
</footer>

            </div>

            
                
                <a href="../getting-started/atCommands.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Sending AT Commands">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"\"OK Google, start my car!\"","level":"1.4.7","depth":2,"previous":{"title":"Sending AT Commands","level":"1.4.6","depth":2,"path":"superB/getting-started/atCommands.md","ref":"superB/getting-started/atCommands.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["ga","custom-favicon","edit-link","page-toc"],"pluginsConfig":{"search":{},"page-toc":{"position":"before-first","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4","showByDefault":true},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"favicon":"images/favicon.ico","custom-favicon":{},"ga":{"configuration":"auto","token":"UA-75126303-1"},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","base":"https://github.com/macchina/docs/edit/master/"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"index.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"./styles/website.css"}},"file":{"path":"superB/projects/ok_google_start_my_car.md","mtime":"2019-06-18T12:52:39.332Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-06-18T12:53:45.619Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>


        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

